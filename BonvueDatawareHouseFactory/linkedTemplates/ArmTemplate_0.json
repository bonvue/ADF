{
	"$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
	"contentVersion": "1.0.0.0",
	"parameters": {
		"factoryName": {
			"type": "string",
			"metadata": "Data Factory name",
			"defaultValue": "bonvuedatawarehousefactory"
		},
		"BonvueExactFunctions_functionKey": {
			"type": "secureString",
			"metadata": "Secure string for 'functionKey' of 'BonvueExactFunctions'"
		},
		"LS_BonvueSQL_connectionString": {
			"type": "secureString",
			"metadata": "Secure string for 'connectionString' of 'LS_BonvueSQL'"
		},
		"BonvueExactFunctions_properties_typeProperties_functionAppUrl": {
			"type": "string",
			"defaultValue": "https://bonvueazurefunctionsexact.azurewebsites.net"
		},
		"LS_REST_EOL_properties_typeProperties_url": {
			"type": "string",
			"defaultValue": "https://start.exactonline.nl"
		},
		"LS_KeyVaultBonvue_properties_typeProperties_baseUrl": {
			"type": "string",
			"defaultValue": "https://KeyVaultBonvue.vault.azure.net/"
		},
		"LS_REST_Simplicate_properties_typeProperties_url": {
			"type": "string",
			"defaultValue": "https://bonvue.simplicate.nl/api/v2"
		}
	},
	"variables": {
		"factoryId": "[concat('Microsoft.DataFactory/factories/', parameters('factoryName'))]"
	},
	"resources": [
		{
			"name": "[concat(parameters('factoryName'), '/BonvueExactFunctions')]",
			"type": "Microsoft.DataFactory/factories/linkedServices",
			"apiVersion": "2018-06-01",
			"properties": {
				"annotations": [],
				"type": "AzureFunction",
				"typeProperties": {
					"functionAppUrl": "[parameters('BonvueExactFunctions_properties_typeProperties_functionAppUrl')]",
					"functionKey": {
						"type": "SecureString",
						"value": "[parameters('BonvueExactFunctions_functionKey')]"
					}
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/LS_REST_EOL')]",
			"type": "Microsoft.DataFactory/factories/linkedServices",
			"apiVersion": "2018-06-01",
			"properties": {
				"annotations": [],
				"type": "RestService",
				"typeProperties": {
					"url": "[parameters('LS_REST_EOL_properties_typeProperties_url')]",
					"enableServerCertificateValidation": false,
					"authenticationType": "Anonymous"
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/LS_BonvueSQL')]",
			"type": "Microsoft.DataFactory/factories/linkedServices",
			"apiVersion": "2018-06-01",
			"properties": {
				"annotations": [],
				"type": "AzureSqlDatabase",
				"typeProperties": {
					"connectionString": "[parameters('LS_BonvueSQL_connectionString')]"
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/LS_KeyVaultBonvue')]",
			"type": "Microsoft.DataFactory/factories/linkedServices",
			"apiVersion": "2018-06-01",
			"properties": {
				"annotations": [],
				"type": "AzureKeyVault",
				"typeProperties": {
					"baseUrl": "[parameters('LS_KeyVaultBonvue_properties_typeProperties_baseUrl')]"
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/LS_REST_Simplicate')]",
			"type": "Microsoft.DataFactory/factories/linkedServices",
			"apiVersion": "2018-06-01",
			"properties": {
				"annotations": [],
				"type": "RestService",
				"typeProperties": {
					"url": "[parameters('LS_REST_Simplicate_properties_typeProperties_url')]",
					"enableServerCertificateValidation": true,
					"authenticationType": "Anonymous",
					"authHeaders": {
						"Authentication-Key": {
							"type": "AzureKeyVaultSecret",
							"store": {
								"referenceName": "LS_KeyVaultBonvue",
								"type": "LinkedServiceReference"
							},
							"secretName": "Authentication-Key"
						},
						"Authentication-Secret": {
							"type": "AzureKeyVaultSecret",
							"store": {
								"referenceName": "LS_KeyVaultBonvue",
								"type": "LinkedServiceReference"
							},
							"secretName": "Authentication-Secret"
						}
					}
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/LS_KeyVaultBonvue')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/DS_BonvueSQL_CostCenters')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "LS_BonvueSQL",
					"type": "LinkedServiceReference"
				},
				"folder": {
					"name": "Exact DW"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [],
				"typeProperties": {
					"schema": "dbo",
					"table": "CostCenters"
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/LS_BonvueSQL')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/DS_EOL_COSTCENTERS')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "LS_REST_EOL",
					"type": "LinkedServiceReference"
				},
				"parameters": {
					"division": {
						"type": "string",
						"defaultValue": "2928333"
					}
				},
				"folder": {
					"name": "Exact REST API"
				},
				"annotations": [],
				"type": "RestResource",
				"typeProperties": {
					"relativeUrl": {
						"value": "/api/v1/@{dataset().division}/hrm/Costcenters?$select=ID,Active,Code,Created,Creator,CreatorFullName,Description,Division,EndDate,Modified,Modifier,ModifierFullName",
						"type": "Expression"
					}
				},
				"schema": []
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/LS_REST_EOL')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/DS_EOL_BANKENTRIES')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "LS_REST_EOL",
					"type": "LinkedServiceReference"
				},
				"parameters": {
					"division": {
						"type": "string",
						"defaultValue": "2928333"
					}
				},
				"folder": {
					"name": "Exact REST API"
				},
				"annotations": [],
				"type": "RestResource",
				"typeProperties": {
					"relativeUrl": {
						"value": "/api/v1/@{dataset().division}/financialtransaction/BankEntries?$select=EntryID,BankStatementDocument,BankStatementDocumentNumber,BankStatementDocumentSubject,ClosingBalanceFC,Created,Currency,Division,EntryNumber,FinancialPeriod,FinancialYear,JournalCode,JournalDescription,Modified,OpeningBalanceFC,Status,StatusDescription",
						"type": "Expression"
					}
				},
				"schema": []
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/LS_REST_EOL')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/DS_EOL_GLACCOUNTCLASSIFICATIONMAPPINGS')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "LS_REST_EOL",
					"type": "LinkedServiceReference"
				},
				"parameters": {
					"division": {
						"type": "string",
						"defaultValue": "2928333"
					}
				},
				"folder": {
					"name": "Exact REST API"
				},
				"annotations": [],
				"type": "RestResource",
				"typeProperties": {
					"relativeUrl": {
						"value": "/api/v1/@{dataset().division}/financial/GLAccountClassificationMappings?$select=ID,Classification,ClassificationCode,ClassificationDescription,Division,GLAccount,GLAccountCode,GLAccountDescription,GLSchemeCode,GLSchemeDescription,GLSchemeID",
						"type": "Expression"
					}
				},
				"schema": []
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/LS_REST_EOL')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/DS_EOL_AGINGPAYABLESLIST')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "LS_REST_EOL",
					"type": "LinkedServiceReference"
				},
				"parameters": {
					"division": {
						"type": "string",
						"defaultValue": "2928333"
					}
				},
				"folder": {
					"name": "Exact REST API"
				},
				"annotations": [],
				"type": "RestResource",
				"typeProperties": {
					"relativeUrl": {
						"value": "/api/v1/@{dataset().division}/read/financial/AgingPayablesList?$select=AccountId,AccountCode,AccountName,AgeGroup1,AgeGroup1Amount,AgeGroup1Description,AgeGroup2,AgeGroup2Amount,AgeGroup2Description,AgeGroup3,AgeGroup3Amount,AgeGroup3Description,AgeGroup4,AgeGroup4Amount,AgeGroup4Description,CurrencyCode,TotalAmount",
						"type": "Expression"
					}
				},
				"schema": []
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/LS_REST_EOL')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/DS_BonvueSQL_AgingPayableList')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "LS_BonvueSQL",
					"type": "LinkedServiceReference"
				},
				"folder": {
					"name": "Exact DW"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [],
				"typeProperties": {
					"schema": "dbo",
					"table": "AgingPayableList"
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/LS_BonvueSQL')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/DS_BonvueSQL_GLAccounts')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "LS_BonvueSQL",
					"type": "LinkedServiceReference"
				},
				"folder": {
					"name": "Exact DW"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [],
				"typeProperties": {
					"schema": "dbo",
					"table": "GLAccounts"
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/LS_BonvueSQL')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/DS_EOL_GLACCOUNTS')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "LS_REST_EOL",
					"type": "LinkedServiceReference"
				},
				"parameters": {
					"division": {
						"type": "string",
						"defaultValue": "2928333"
					}
				},
				"folder": {
					"name": "Exact REST API"
				},
				"annotations": [],
				"type": "RestResource",
				"typeProperties": {
					"relativeUrl": {
						"value": "/api/v1/@{dataset().division}/bulk/Financial/GLAccounts?$select=ID,AssimilatedVATBox,BalanceSide,BalanceType,BelcotaxType,Code,Compress,Costcenter,CostcenterDescription,Costunit,CostunitDescription,Created,Creator,CreatorFullName,DeductibilityPercentages,Description,Division,ExcludeVATListing,IsBlocked,Matching,Modified,Modifier,PrivateGLAccount,PrivatePercentage,ReportingCode,RevalueCurrency,SearchCode,Type,TypeDescription,UseCostcenter,UseCostunit,VATCode,VATDescription,VATGLAccountType,VATNonDeductibleGLAccount,VATNonDeductiblePercentage,VATSystem,YearEndCostGLAccount,YearEndReflectionGLAccount",
						"type": "Expression"
					}
				},
				"schema": []
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/LS_REST_EOL')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/DS_EOL_JOBTITLES')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "LS_REST_EOL",
					"type": "LinkedServiceReference"
				},
				"parameters": {
					"division": {
						"type": "string",
						"defaultValue": "2928333"
					}
				},
				"folder": {
					"name": "Exact REST API"
				},
				"annotations": [],
				"type": "RestResource",
				"typeProperties": {
					"relativeUrl": {
						"value": "/api/v1/@{dataset().division}/hrm/JobTitles?$select=ID,Code,Created,CreatorFullName,Description,Division,JobCode,JobGroup,JobGroupCode,JobGroupDescription,JobLevelFrom,JobLevelTo,Modified,ModifierFullName,Notes",
						"type": "Expression"
					}
				},
				"schema": []
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/LS_REST_EOL')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/DS_EOL_GLCLASSIFICATIONS')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "LS_REST_EOL",
					"type": "LinkedServiceReference"
				},
				"parameters": {
					"division": {
						"type": "string",
						"defaultValue": "2928333"
					}
				},
				"folder": {
					"name": "Exact REST API"
				},
				"annotations": [],
				"type": "RestResource",
				"typeProperties": {
					"relativeUrl": {
						"value": "/api/v1/@{dataset().division}/bulk/Financial/GLClassifications?$select=ID,Abstract,Balance,Code,Created,CreatorFullName,Description,Division,IsTupleSubElement,Modified,Modifier,ModifierFullName,Name,PeriodType,SubstitutionGroup,TaxonomyNamespaceDescription",
						"type": "Expression"
					}
				},
				"schema": []
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/LS_REST_EOL')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/DS_EOL_RECEIVABLES')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "LS_REST_EOL",
					"type": "LinkedServiceReference"
				},
				"parameters": {
					"division": {
						"type": "string",
						"defaultValue": "2928333"
					}
				},
				"folder": {
					"name": "Exact REST API"
				},
				"annotations": [],
				"type": "RestResource",
				"typeProperties": {
					"relativeUrl": {
						"value": "/api/v1/@{dataset().division}/bulk/Cashflow/Receivables?$select=ID,Account,AccountBankAccountID,AccountBankAccountNumber,AccountCode,AccountContact,AccountContactName,AccountCountry,AccountName,AmountDC,AmountDiscountDC,AmountDiscountFC,AmountFC,BankAccountID,BankAccountNumber,CashflowTransactionBatchCode,Created,CreatorFullName,Currency,Description,DirectDebitMandate,DirectDebitMandateDescription,DirectDebitMandatePaymentType,DirectDebitMandateReference,DirectDebitMandateType,DiscountDueDate,Division,Document,DocumentNumber,DocumentSubject,DueDate,EndDate,EndPeriod,EndToEndID,EndYear,EntryDate,EntryID,EntryNumber,GLAccountCode,GLAccountDescription,InvoiceDate,InvoiceNumber,IsBatchBooking,IsFullyPaid,Journal,JournalDescription,LastPaymentDate,Modified,ModifierFullName,PaymentCondition,PaymentConditionDescription,PaymentDays,PaymentDaysDiscount,PaymentDiscountPercentage,PaymentInformationID,PaymentMethod,PaymentReference,RateFC,ReceivableBatchNumber,ReceivableSelected,ReceivableSelector,ReceivableSelectorFullName,Source,Status,TransactionAmountDC,TransactionAmountFC,TransactionDueDate,TransactionEntryID,TransactionID,TransactionIsReversal,TransactionReportingPeriod,TransactionReportingYear,TransactionStatus,TransactionType,YourRef",
						"type": "Expression"
					}
				},
				"schema": []
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/LS_REST_EOL')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/DS_EOL_PURCHASEENTRIES')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "LS_REST_EOL",
					"type": "LinkedServiceReference"
				},
				"parameters": {
					"division": {
						"type": "string",
						"defaultValue": "2928333"
					}
				},
				"folder": {
					"name": "Exact REST API"
				},
				"annotations": [],
				"type": "RestResource",
				"typeProperties": {
					"relativeUrl": {
						"value": "/api/v1/@{dataset().division}/purchaseentry/PurchaseEntries?$select=EntryID,AmountDC,AmountFC,BatchNumber,Created,CreatorFullName,Currency,Description,Division,Document,DocumentNumber,DocumentSubject,DueDate,EntryDate,EntryNumber,ExternalLinkDescription,ExternalLinkReference,GAccountAmountFC,InvoiceNumber,Journal,JournalDescription,Modified,ModifierFullName,OrderNumber,PaymentCondition,PaymentConditionDescription,PaymentReference,ProcessNumber,PurchaseEntryLines,Rate,ReportingPeriod,ReportingYear,Reversal,Status,StatusDescription,Supplier,SupplierName,Type,TypeDescription,VATAmountDC,VATAmountFC,YourRef",
						"type": "Expression"
					}
				},
				"schema": []
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/LS_REST_EOL')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/DS_BonvueSQL_GLAccountClassificationMappings')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "LS_BonvueSQL",
					"type": "LinkedServiceReference"
				},
				"folder": {
					"name": "Exact DW"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [],
				"typeProperties": {
					"schema": "dbo",
					"table": "GLAccountClassificationMappings"
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/LS_BonvueSQL')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/DS_EOL_PAYMENTS')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "LS_REST_EOL",
					"type": "LinkedServiceReference"
				},
				"parameters": {
					"division": {
						"type": "string",
						"defaultValue": "2928333"
					}
				},
				"folder": {
					"name": "Exact REST API"
				},
				"annotations": [],
				"type": "RestResource",
				"typeProperties": {
					"relativeUrl": {
						"value": "/api/v1/@{dataset().division}/cashflow/Payments?$select=ID,Account,AccountBankAccountID,AccountBankAccountNumber,AccountCode,AccountContact,AccountContactName,AccountName,AmountDC,AmountDiscountDC,AmountDiscountFC,AmountFC,BankAccountID,BankAccountNumber,CashflowTransactionBatchCode,Created,CreatorFullName,Currency,Description,DiscountDueDate,Division,Document,DocumentNumber,DocumentSubject,DueDate,EndDate,EndPeriod,EndYear,EntryDate,EntryID,EntryNumber,GLAccount,GLAccountCode,GLAccountDescription,InvoiceDate,InvoiceNumber,IsBatchBooking,Journal,JournalDescription,Modified,ModifierFullName,PaymentBatchNumber,PaymentCondition,PaymentConditionDescription,PaymentDays,PaymentDaysDiscount,PaymentDiscountPercentage,PaymentMethod,PaymentReference,PaymentSelected,PaymentSelector,PaymentSelectorFullName,RateFC,Source,Status,TransactionAmountDC,TransactionAmountFC,TransactionDueDate,TransactionEntryID,TransactionID,TransactionIsReversal,TransactionReportingPeriod,TransactionReportingYear,TransactionStatus,TransactionType,YourRef",
						"type": "Expression"
					}
				},
				"schema": []
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/LS_REST_EOL')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/DS_BonvueSQL_PurchaseEntries')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "LS_BonvueSQL",
					"type": "LinkedServiceReference"
				},
				"folder": {
					"name": "Exact DW"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [],
				"typeProperties": {
					"schema": "dbo",
					"table": "PurchaseEntries"
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/LS_BonvueSQL')]"
			]
		}
	]
}